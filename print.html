<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ORMP</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">src</li><li class="chapter-item "><a href="src/eco/index.html">❱ eco</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/eco/Oracle.sol/contract.Oracle.html">Oracle</a></li><li class="chapter-item "><a href="src/eco/Relayer.sol/contract.Relayer.html">Relayer</a></li></ol></li><li class="chapter-item "><a href="src/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/interfaces/IORMP.sol/interface.IORMP.html">IORMP</a></li><li class="chapter-item "><a href="src/interfaces/IOracle.sol/interface.IOracle.html">IOracle</a></li><li class="chapter-item "><a href="src/interfaces/IRelayer.sol/interface.IRelayer.html">IRelayer</a></li><li class="chapter-item "><a href="src/interfaces/IVerifier.sol/interface.IVerifier.html">IVerifier</a></li></ol></li><li class="chapter-item "><a href="src/security/index.html">❱ security</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/security/ExcessivelySafeCall.sol/library.ExcessivelySafeCall.html">ExcessivelySafeCall</a></li><li class="chapter-item "><a href="src/security/ReentrancyGuard.sol/abstract.ReentrancyGuard.html">ReentrancyGuard</a></li></ol></li><li class="chapter-item "><a href="src/user/index.html">❱ user</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/user/AppBase.sol/abstract.AppBase.html">AppBase</a></li><li class="chapter-item "><a href="src/user/Application.sol/abstract.Application.html">Application</a></li></ol></li><li class="chapter-item "><a href="src/Channel.sol/contract.Channel.html">Channel</a></li><li class="chapter-item "><a href="src/Common.sol/struct.Message.html">Message</a></li><li class="chapter-item "><a href="src/Common.sol/function.hash.html">hash</a></li><li class="chapter-item "><a href="src/ORMP.sol/contract.ORMP.html">ORMP</a></li><li class="chapter-item "><a href="src/UserConfig.sol/struct.UC.html">UC</a></li><li class="chapter-item "><a href="src/UserConfig.sol/contract.UserConfig.html">UserConfig</a></li><li class="chapter-item "><a href="src/Verifier.sol/abstract.Verifier.html">Verifier</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ORMP</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/msgport/ORMP" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ormp"><a class="header" href="#ormp">ORMP</a></h1>
<p>Oracle and Relayer based Message Protocol.</p>
<h2 id="deployments"><a class="header" href="#deployments">Deployments</a></h2>
<p>See https://github.com/darwinia-network/contracts-deploy</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>To install with <a href="https://github.com/gakonst/foundry"><strong>Foundry</strong></a>:</p>
<pre><code class="language-sh">forge install msgport/ORMP
</code></pre>
<p>To install with <a href="https://github.com/nomiclabs/hardhat"><strong>Hardhat</strong></a> or <a href="https://github.com/trufflesuite/truffle"><strong>Truffle</strong></a>:</p>
<pre><code class="language-sh">npm install @darwinia/ormp
</code></pre>
<h2 id="install"><a class="header" href="#install">Install</a></h2>
<p>To install dependencies and compile contracts:</p>
<pre><code class="language-sh">git clone --recurse-submodules https://github.com/darwinia-network/ORMP.git &amp;&amp; cd ORMP
make tools
make
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="src/eco/Oracle.sol/contract.Oracle.html">Oracle</a></li>
<li><a href="src/eco/Relayer.sol/contract.Relayer.html">Relayer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="oracle"><a class="header" href="#oracle">Oracle</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/eco/Oracle.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/eco/Oracle.sol//src/Verifier.sol/abstract.Verifier.html">Verifier</a></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="protocol"><a class="header" href="#protocol">PROTOCOL</a></h3>
<pre><code class="language-solidity">address public immutable PROTOCOL;
</code></pre>
<h3 id="owner"><a class="header" href="#owner">owner</a></h3>
<pre><code class="language-solidity">address public owner;
</code></pre>
<h3 id="feeof"><a class="header" href="#feeof">feeOf</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; uint256) public feeOf;
</code></pre>
<h3 id="approvedof"><a class="header" href="#approvedof">approvedOf</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public approvedOf;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="onlyowner"><a class="header" href="#onlyowner">onlyOwner</a></h3>
<pre><code class="language-solidity">modifier onlyOwner();
</code></pre>
<h3 id="onlyapproved"><a class="header" href="#onlyapproved">onlyApproved</a></h3>
<pre><code class="language-solidity">modifier onlyApproved();
</code></pre>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<pre><code class="language-solidity">constructor(address dao, address ormp);
</code></pre>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="version"><a class="header" href="#version">version</a></h3>
<pre><code class="language-solidity">function version() public pure returns (string memory);
</code></pre>
<h3 id="importmessagehash"><a class="header" href="#importmessagehash">importMessageHash</a></h3>
<p><em>Only could be called by owner.</em></p>
<pre><code class="language-solidity">function importMessageHash(uint256 chainId, address channel, uint256 msgIndex, bytes32 msgHash) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>The source chain id.</td></tr>
<tr><td><code>channel</code></td><td><code>address</code></td><td>The message channel.</td></tr>
<tr><td><code>msgIndex</code></td><td><code>uint256</code></td><td>The source chain message index.</td></tr>
<tr><td><code>msgHash</code></td><td><code>bytes32</code></td><td>The source chain message hash corresponding to the channel.</td></tr>
</tbody></table>
</div>
<h3 id="hashof"><a class="header" href="#hashof">hashOf</a></h3>
<pre><code class="language-solidity">function hashOf(uint256 chainId, address channel, uint256 msgIndex) public view override returns (bytes32);
</code></pre>
<h3 id="changeowner"><a class="header" href="#changeowner">changeOwner</a></h3>
<pre><code class="language-solidity">function changeOwner(address newOwner) external onlyOwner;
</code></pre>
<h3 id="setapproved"><a class="header" href="#setapproved">setApproved</a></h3>
<pre><code class="language-solidity">function setApproved(address operator, bool approve) external onlyOwner;
</code></pre>
<h3 id="isapproved"><a class="header" href="#isapproved">isApproved</a></h3>
<pre><code class="language-solidity">function isApproved(address operator) public view returns (bool);
</code></pre>
<h3 id="withdraw"><a class="header" href="#withdraw">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(address to, uint256 amount) external onlyApproved;
</code></pre>
<h3 id="setfee"><a class="header" href="#setfee">setFee</a></h3>
<pre><code class="language-solidity">function setFee(uint256 chainId, uint256 fee_) external onlyApproved;
</code></pre>
<h3 id="fee"><a class="header" href="#fee">fee</a></h3>
<pre><code class="language-solidity">function fee(uint256 toChainId, address) public view returns (uint256);
</code></pre>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="setfee-1"><a class="header" href="#setfee-1">SetFee</a></h3>
<pre><code class="language-solidity">event SetFee(uint256 indexed chainId, uint256 fee);
</code></pre>
<h3 id="setapproved-1"><a class="header" href="#setapproved-1">SetApproved</a></h3>
<pre><code class="language-solidity">event SetApproved(address operator, bool approve);
</code></pre>
<h3 id="withdrawal"><a class="header" href="#withdrawal">Withdrawal</a></h3>
<pre><code class="language-solidity">event Withdrawal(address indexed to, uint256 amt);
</code></pre>
<h3 id="ownershiptransferred"><a class="header" href="#ownershiptransferred">OwnershipTransferred</a></h3>
<pre><code class="language-solidity">event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relayer"><a class="header" href="#relayer">Relayer</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/eco/Relayer.sol">Git Source</a></p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="protocol-1"><a class="header" href="#protocol-1">PROTOCOL</a></h3>
<pre><code class="language-solidity">address public immutable PROTOCOL;
</code></pre>
<h3 id="owner-1"><a class="header" href="#owner-1">owner</a></h3>
<pre><code class="language-solidity">address public owner;
</code></pre>
<h3 id="priceof"><a class="header" href="#priceof">priceOf</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; DstPrice) public priceOf;
</code></pre>
<h3 id="configof"><a class="header" href="#configof">configOf</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; DstConfig) public configOf;
</code></pre>
<h3 id="approvedof-1"><a class="header" href="#approvedof-1">approvedOf</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public approvedOf;
</code></pre>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="onlyowner-1"><a class="header" href="#onlyowner-1">onlyOwner</a></h3>
<pre><code class="language-solidity">modifier onlyOwner();
</code></pre>
<h3 id="onlyapproved-1"><a class="header" href="#onlyapproved-1">onlyApproved</a></h3>
<pre><code class="language-solidity">modifier onlyApproved();
</code></pre>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<pre><code class="language-solidity">constructor(address dao, address ormp);
</code></pre>
<h3 id="version-1"><a class="header" href="#version-1">version</a></h3>
<pre><code class="language-solidity">function version() public pure returns (string memory);
</code></pre>
<h3 id="receive-1"><a class="header" href="#receive-1">receive</a></h3>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="withdraw-1"><a class="header" href="#withdraw-1">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(address to, uint256 amount) external onlyApproved;
</code></pre>
<h3 id="isapproved-1"><a class="header" href="#isapproved-1">isApproved</a></h3>
<pre><code class="language-solidity">function isApproved(address operator) public view returns (bool);
</code></pre>
<h3 id="changeowner-1"><a class="header" href="#changeowner-1">changeOwner</a></h3>
<pre><code class="language-solidity">function changeOwner(address newOwner) external onlyOwner;
</code></pre>
<h3 id="setapproved-2"><a class="header" href="#setapproved-2">setApproved</a></h3>
<pre><code class="language-solidity">function setApproved(address operator, bool approve) public onlyOwner;
</code></pre>
<h3 id="setdstprice"><a class="header" href="#setdstprice">setDstPrice</a></h3>
<pre><code class="language-solidity">function setDstPrice(uint256 chainId, uint128 dstPriceRatio, uint128 dstGasPriceInWei) external onlyApproved;
</code></pre>
<h3 id="setdstconfig"><a class="header" href="#setdstconfig">setDstConfig</a></h3>
<pre><code class="language-solidity">function setDstConfig(uint256 chainId, uint64 baseGas, uint64 gasPerByte) external onlyApproved;
</code></pre>
<h3 id="fee-1"><a class="header" href="#fee-1">fee</a></h3>
<pre><code class="language-solidity">function fee(uint256 toChainId, address, uint256 gasLimit, bytes calldata encoded, bytes calldata)
    public
    view
    returns (uint256);
</code></pre>
<h3 id="relay"><a class="header" href="#relay">relay</a></h3>
<pre><code class="language-solidity">function relay(Message calldata message) external onlyApproved;
</code></pre>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="setdstprice-1"><a class="header" href="#setdstprice-1">SetDstPrice</a></h3>
<pre><code class="language-solidity">event SetDstPrice(uint256 indexed chainId, uint128 dstPriceRatio, uint128 dstGasPriceInWei);
</code></pre>
<h3 id="setdstconfig-1"><a class="header" href="#setdstconfig-1">SetDstConfig</a></h3>
<pre><code class="language-solidity">event SetDstConfig(uint256 indexed chainId, uint64 baseGas, uint64 gasPerByte);
</code></pre>
<h3 id="setapproved-3"><a class="header" href="#setapproved-3">SetApproved</a></h3>
<pre><code class="language-solidity">event SetApproved(address operator, bool approve);
</code></pre>
<h3 id="ownershiptransferred-1"><a class="header" href="#ownershiptransferred-1">OwnershipTransferred</a></h3>
<pre><code class="language-solidity">event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="dstprice"><a class="header" href="#dstprice">DstPrice</a></h3>
<pre><code class="language-solidity">struct DstPrice {
    uint128 dstPriceRatio;
    uint128 dstGasPriceInWei;
}
</code></pre>
<h3 id="dstconfig"><a class="header" href="#dstconfig">DstConfig</a></h3>
<pre><code class="language-solidity">struct DstConfig {
    uint64 baseGas;
    uint64 gasPerByte;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="src/interfaces/IORMP.sol/interface.IORMP.html">IORMP</a></li>
<li><a href="src/interfaces/IOracle.sol/interface.IOracle.html">IOracle</a></li>
<li><a href="src/interfaces/IRelayer.sol/interface.IRelayer.html">IRelayer</a></li>
<li><a href="src/interfaces/IVerifier.sol/interface.IVerifier.html">IVerifier</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iormp"><a class="header" href="#iormp">IORMP</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/interfaces/IORMP.sol">Git Source</a></p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="send"><a class="header" href="#send">send</a></h3>
<p>follow https://eips.ethereum.org/EIPS/eip-5750</p>
<p><em>Send a cross-chain message over the endpoint.</em></p>
<pre><code class="language-solidity">function send(
    uint256 toChainId,
    address to,
    uint256 gasLimit,
    bytes calldata encoded,
    address refund,
    bytes calldata params
) external payable returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The Message destination chain id.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>User application contract address which receive the message.</td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
<tr><td><code>refund</code></td><td><code>address</code></td><td>Return extra fee to refund address.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>General extensibility for relayer to custom functionality.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Return the hash of the message as message id.</td></tr>
</tbody></table>
</div>
<h3 id="fee-2"><a class="header" href="#fee-2">fee</a></h3>
<p>Get a quote in source native gas, for the amount that send() requires to pay for message delivery.</p>
<pre><code class="language-solidity">function fee(uint256 toChainId, address ua, uint256 gasLimit, bytes calldata encoded, bytes calldata params)
    external
    view
    returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The Message destination chain id.</td></tr>
<tr><td><code>ua</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>General extensibility for relayer to custom functionality.</td></tr>
</tbody></table>
</div>
<h3 id="recv"><a class="header" href="#recv">recv</a></h3>
<p><em>Recv verified message and dispatch to destination user application address.</em></p>
<pre><code class="language-solidity">function recv(Message calldata message, bytes calldata proof) external payable returns (bool dispatchResult);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>Message</code></td><td>Verified receive message info.</td></tr>
<tr><td><code>proof</code></td><td><code>bytes</code></td><td>Message proof of this message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>dispatchResult</code></td><td><code>bool</code></td><td>Result of the message dispatch.</td></tr>
</tbody></table>
</div>
<h3 id="getappconfig"><a class="header" href="#getappconfig">getAppConfig</a></h3>
<p>If user application has not configured, then the default config is used.</p>
<p><em>Fetch user application config.</em></p>
<pre><code class="language-solidity">function getAppConfig(address ua) external view returns (address oracle, address relayer);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ua</code></td><td><code>address</code></td><td>User application contract address.</td></tr>
</tbody></table>
</div>
<h3 id="setappconfig"><a class="header" href="#setappconfig">setAppConfig</a></h3>
<p>Set user application config.</p>
<pre><code class="language-solidity">function setAppConfig(address oracle, address relayer) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Oracle which user application choose.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Relayer which user application choose.</td></tr>
</tbody></table>
</div>
<h3 id="defaultuc"><a class="header" href="#defaultuc">defaultUC</a></h3>
<pre><code class="language-solidity">function defaultUC() external view returns (address oracle, address relayer);
</code></pre>
<h3 id="dones"><a class="header" href="#dones">dones</a></h3>
<p><em>Check the msg if it is dispatched.</em></p>
<pre><code class="language-solidity">function dones(bytes32 msgHash) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>msgHash</code></td><td><code>bytes32</code></td><td>Hash of the checked message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Return the dispatched result of the checked message.</td></tr>
</tbody></table>
</div>
<h3 id="importhash"><a class="header" href="#importhash">importHash</a></h3>
<p>Hash is an abstract of the proof system, it can be a block hash or a message root hash,
specifically provided by oracles.</p>
<p><em>Import hash by any oracle address.</em></p>
<pre><code class="language-solidity">function importHash(uint256 chainId, address channel, uint256 msgIndex, bytes32 hash_) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>The source chain id.</td></tr>
<tr><td><code>channel</code></td><td><code>address</code></td><td>The message channel.</td></tr>
<tr><td><code>msgIndex</code></td><td><code>uint256</code></td><td>The source chain message index.</td></tr>
<tr><td><code>hash_</code></td><td><code>bytes32</code></td><td>The hash to import.</td></tr>
</tbody></table>
</div>
<h3 id="hashlookup"><a class="header" href="#hashlookup">hashLookup</a></h3>
<p><em>Fetch hash.</em></p>
<pre><code class="language-solidity">function hashLookup(address oracle, bytes32 lookupKey) external view returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>The oracle address.</td></tr>
<tr><td><code>lookupKey</code></td><td><code>bytes32</code></td><td>The key for loop up hash.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Return the hash imported by the oracle.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ioracle"><a class="header" href="#ioracle">IOracle</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/interfaces/IOracle.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/interfaces/IOracle.sol//src/interfaces/IVerifier.sol/interface.IVerifier.html">IVerifier</a></p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="fee-3"><a class="header" href="#fee-3">fee</a></h3>
<p>Fetch oracle price to relay message root to the destination chain.</p>
<pre><code class="language-solidity">function fee(uint256 toChainId, address ua) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The destination chain id.</td></tr>
<tr><td><code>ua</code></td><td><code>address</code></td><td>The user application which send the message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Oracle price in source native gas.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="irelayer"><a class="header" href="#irelayer">IRelayer</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/interfaces/IRelayer.sol">Git Source</a></p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="fee-4"><a class="header" href="#fee-4">fee</a></h3>
<p>Fetch relayer price to relay message to the destination chain.</p>
<pre><code class="language-solidity">function fee(uint256 toChainId, address ua, uint256 gasLimit, bytes calldata encoded, bytes calldata params)
    external
    view
    returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The destination chain id.</td></tr>
<tr><td><code>ua</code></td><td><code>address</code></td><td>The user application which send the message.</td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>General extensibility for relayer to custom functionality.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Relayer price in source native gas.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iverifier"><a class="header" href="#iverifier">IVerifier</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/interfaces/IVerifier.sol">Git Source</a></p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="verifymessageproof"><a class="header" href="#verifymessageproof">verifyMessageProof</a></h3>
<p>Verify message proof</p>
<p><em>Message proof provided by relayer. Oracle should provide message root of
source chain, and verify the merkle proof of the message hash.</em></p>
<pre><code class="language-solidity">function verifyMessageProof(Message calldata message, bytes calldata proof) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>Message</code></td><td>The message info.</td></tr>
<tr><td><code>proof</code></td><td><code>bytes</code></td><td>Proof of the message</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Result of the message verify.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="src/security/ExcessivelySafeCall.sol/library.ExcessivelySafeCall.html">ExcessivelySafeCall</a></li>
<li><a href="src/security/ReentrancyGuard.sol/abstract.ReentrancyGuard.html">ReentrancyGuard</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="excessivelysafecall"><a class="header" href="#excessivelysafecall">ExcessivelySafeCall</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/security/ExcessivelySafeCall.sol">Git Source</a></p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="excessivelysafecall-1"><a class="header" href="#excessivelysafecall-1">excessivelySafeCall</a></h3>
<p>Use when you <em>really</em> really <em>really</em> don't trust the called
contract. This prevents the called contract from causing reversion of
the caller in as many ways as we can.</p>
<p><em>The main difference between this and a solidity low-level call is
that we limit the number of bytes that the callee can cause to be
copied to caller memory. This prevents stupid things like malicious
contracts returning 10,000,000 bytes causing a local OOG when copying
to memory.</em></p>
<pre><code class="language-solidity">function excessivelySafeCall(address _target, uint256 _gas, uint256 _value, uint16 _maxCopy, bytes memory _calldata)
    internal
    returns (bool, bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_target</code></td><td><code>address</code></td><td>The address to call</td></tr>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The amount of gas to forward to the remote contract</td></tr>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>Value in wei to send to the account</td></tr>
<tr><td><code>_maxCopy</code></td><td><code>uint16</code></td><td>The maximum number of bytes of returndata to copy to memory.</td></tr>
<tr><td><code>_calldata</code></td><td><code>bytes</code></td><td>The data to send to the remote contract</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>success and returndata, as <code>.call()</code>. Returndata is capped to <code>_maxCopy</code> bytes.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="excessivelysafestaticcall"><a class="header" href="#excessivelysafestaticcall">excessivelySafeStaticCall</a></h3>
<p>Use when you <em>really</em> really <em>really</em> don't trust the called
contract. This prevents the called contract from causing reversion of
the caller in as many ways as we can.</p>
<p><em>The main difference between this and a solidity low-level call is
that we limit the number of bytes that the callee can cause to be
copied to caller memory. This prevents stupid things like malicious
contracts returning 10,000,000 bytes causing a local OOG when copying
to memory.</em></p>
<pre><code class="language-solidity">function excessivelySafeStaticCall(address _target, uint256 _gas, uint16 _maxCopy, bytes memory _calldata)
    internal
    view
    returns (bool, bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_target</code></td><td><code>address</code></td><td>The address to call</td></tr>
<tr><td><code>_gas</code></td><td><code>uint256</code></td><td>The amount of gas to forward to the remote contract</td></tr>
<tr><td><code>_maxCopy</code></td><td><code>uint16</code></td><td>The maximum number of bytes of returndata to copy to memory.</td></tr>
<tr><td><code>_calldata</code></td><td><code>bytes</code></td><td>The data to send to the remote contract</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>success and returndata, as <code>.call()</code>. Returndata is capped to <code>_maxCopy</code> bytes.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="reentrancyguard"><a class="header" href="#reentrancyguard">ReentrancyGuard</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/security/ReentrancyGuard.sol">Git Source</a></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="_not_entered"><a class="header" href="#_not_entered">_NOT_ENTERED</a></h3>
<pre><code class="language-solidity">uint256 private constant _NOT_ENTERED = 1;
</code></pre>
<h3 id="_entered"><a class="header" href="#_entered">_ENTERED</a></h3>
<pre><code class="language-solidity">uint256 private constant _ENTERED = 2;
</code></pre>
<h3 id="_send_state"><a class="header" href="#_send_state">_send_state</a></h3>
<pre><code class="language-solidity">uint256 private _send_state = 1;
</code></pre>
<h3 id="_receive_state"><a class="header" href="#_receive_state">_receive_state</a></h3>
<pre><code class="language-solidity">uint256 private _receive_state = 1;
</code></pre>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="sendnonreentrant"><a class="header" href="#sendnonreentrant">sendNonReentrant</a></h3>
<pre><code class="language-solidity">modifier sendNonReentrant();
</code></pre>
<h3 id="recvnonreentrant"><a class="header" href="#recvnonreentrant">recvNonReentrant</a></h3>
<pre><code class="language-solidity">modifier recvNonReentrant();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="src/user/AppBase.sol/abstract.AppBase.html">AppBase</a></li>
<li><a href="src/user/Application.sol/abstract.Application.html">Application</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appbase"><a class="header" href="#appbase">AppBase</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/user/AppBase.sol">Git Source</a></p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="onlyormp"><a class="header" href="#onlyormp">onlyORMP</a></h3>
<pre><code class="language-solidity">modifier onlyORMP() virtual;
</code></pre>
<h3 id="_messageid"><a class="header" href="#_messageid">_messageId</a></h3>
<pre><code class="language-solidity">function _messageId() internal pure returns (bytes32 _msgDataMessageId);
</code></pre>
<h3 id="_fromchainid"><a class="header" href="#_fromchainid">_fromChainId</a></h3>
<pre><code class="language-solidity">function _fromChainId() internal pure returns (uint256 _msgDataFromChainId);
</code></pre>
<h3 id="_xmsgsender"><a class="header" href="#_xmsgsender">_xmsgSender</a></h3>
<pre><code class="language-solidity">function _xmsgSender() internal pure returns (address payable _from);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="application"><a class="header" href="#application">Application</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/user/Application.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/user/Application.sol//src/user/AppBase.sol/abstract.AppBase.html">AppBase</a></p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="ormp-1"><a class="header" href="#ormp-1">ORMP</a></h3>
<pre><code class="language-solidity">address public immutable ORMP;
</code></pre>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="onlyormp-1"><a class="header" href="#onlyormp-1">onlyORMP</a></h3>
<pre><code class="language-solidity">modifier onlyORMP() override;
</code></pre>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<pre><code class="language-solidity">constructor(address ormp);
</code></pre>
<h3 id="_setappconfig"><a class="header" href="#_setappconfig">_setAppConfig</a></h3>
<pre><code class="language-solidity">function _setAppConfig(address oracle, address relayer) internal virtual;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="channel"><a class="header" href="#channel">Channel</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/Channel.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/Channel.sol//src/UserConfig.sol/contract.UserConfig.html">UserConfig</a></p>
<p>A channel is a logical connection over cross-chain network.
It used for cross-chain message transfer.</p>
<ul>
<li>Accepts messages to be dispatched to destination chains,
constructs a Merkle tree of the messages.</li>
<li>Dispatches verified messages from source chains.</li>
</ul>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="dones-1"><a class="header" href="#dones-1">dones</a></h3>
<p><em>msgHash =&gt; isDispathed.</em></p>
<pre><code class="language-solidity">mapping(bytes32 =&gt; bool) public dones;
</code></pre>
<h3 id="count"><a class="header" href="#count">count</a></h3>
<p><em>message count.</em></p>
<pre><code class="language-solidity">uint256 public count;
</code></pre>
<h3 id="__self"><a class="header" href="#__self">__self</a></h3>
<p><em>Self contract address cache.</em></p>
<pre><code class="language-solidity">address private immutable __self = address(this);
</code></pre>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<p><em>Init code.</em></p>
<pre><code class="language-solidity">constructor(address dao) UserConfig(dao);
</code></pre>
<h3 id="local_chainid"><a class="header" href="#local_chainid">LOCAL_CHAINID</a></h3>
<p><em>Fetch local chain id.</em></p>
<pre><code class="language-solidity">function LOCAL_CHAINID() public view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>chainId Local chain id.</td></tr>
</tbody></table>
</div>
<h3 id="_send"><a class="header" href="#_send">_send</a></h3>
<p><em>Send message.</em></p>
<pre><code class="language-solidity">function _send(address from, uint256 toChainId, address to, uint256 gasLimit, bytes calldata encoded)
    internal
    returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>from</code></td><td><code>address</code></td><td>User application contract address which send the message.</td></tr>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The Message destination chain id.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>User application contract address which receive the message.</td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
</tbody></table>
</div>
<h3 id="_recv"><a class="header" href="#_recv">_recv</a></h3>
<p>Only message.to's config relayer could relay this message.</p>
<p><em>Receive messages.</em></p>
<pre><code class="language-solidity">function _recv(Message calldata message, bytes calldata proof) internal returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>Message</code></td><td>Received message info.</td></tr>
<tr><td><code>proof</code></td><td><code>bytes</code></td><td>Message proof of this message.</td></tr>
</tbody></table>
</div>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="messageaccepted"><a class="header" href="#messageaccepted">MessageAccepted</a></h3>
<p><em>Notifies an observer that the message has been accepted.</em></p>
<pre><code class="language-solidity">event MessageAccepted(bytes32 indexed msgHash, Message message);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>msgHash</code></td><td><code>bytes32</code></td><td>Hash of the message.</td></tr>
<tr><td><code>message</code></td><td><code>Message</code></td><td>Accepted message info.</td></tr>
</tbody></table>
</div>
<h3 id="messagedispatched"><a class="header" href="#messagedispatched">MessageDispatched</a></h3>
<p><em>Notifies an observer that the message has been dispatched.</em></p>
<pre><code class="language-solidity">event MessageDispatched(bytes32 indexed msgHash, bool dispatchResult);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>msgHash</code></td><td><code>bytes32</code></td><td>Hash of the message.</td></tr>
<tr><td><code>dispatchResult</code></td><td><code>bool</code></td><td>The message dispatch result.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="message"><a class="header" href="#message">Message</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/Common.sol">Git Source</a></p>
<p><em>The block of control information and data for comminicate
between user applications. Messages are the exchange medium
used by channels to send and receive data through cross-chain networks.
A message is sent from a source chain to a destination chain.</em></p>
<pre><code class="language-solidity">struct Message {
    address channel;
    uint256 index;
    uint256 fromChainId;
    address from;
    uint256 toChainId;
    address to;
    uint256 gasLimit;
    bytes encoded;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>channel</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>index</code></td><td><code>uint256</code></td><td>The leaf index lives in channel's incremental mekle tree.</td></tr>
<tr><td><code>fromChainId</code></td><td><code>uint256</code></td><td>The message source chain id.</td></tr>
<tr><td><code>from</code></td><td><code>address</code></td><td>User application contract address which send the message.</td></tr>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The message destination chain id.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>User application contract address which receive the message.</td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination UA used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="hash"><a class="header" href="#hash">hash</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/Common.sol">Git Source</a></p>
<p><em>Hash of the message.</em></p>
<pre><code class="language-solidity">function hash(Message memory message) pure returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ormp-2"><a class="header" href="#ormp-2">ORMP</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/ORMP.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/ORMP.sol//src/security/ReentrancyGuard.sol/abstract.ReentrancyGuard.html">ReentrancyGuard</a>, <a href="src/ORMP.sol//src/Channel.sol/contract.Channel.html">Channel</a></p>
<p>An endpoint is a type of network node for cross-chain communication.
It is an interface exposed by a communication channel.</p>
<p><em>An endpoint is associated with an immutable channel and user configuration.</em></p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="hashlookup-1"><a class="header" href="#hashlookup-1">hashLookup</a></h3>
<p>oracle =&gt; lookupKey =&gt; hash</p>
<pre><code class="language-solidity">mapping(address =&gt; mapping(bytes32 =&gt; bytes32)) public hashLookup;
</code></pre>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="constructor-4"><a class="header" href="#constructor-4">constructor</a></h3>
<pre><code class="language-solidity">constructor(address dao) Channel(dao);
</code></pre>
<h3 id="version-2"><a class="header" href="#version-2">version</a></h3>
<pre><code class="language-solidity">function version() public pure returns (string memory);
</code></pre>
<h3 id="send-1"><a class="header" href="#send-1">send</a></h3>
<p>follow https://eips.ethereum.org/EIPS/eip-5750</p>
<p><em>Send a cross-chain message over the endpoint.</em></p>
<pre><code class="language-solidity">function send(
    uint256 toChainId,
    address to,
    uint256 gasLimit,
    bytes calldata encoded,
    address refund,
    bytes calldata params
) external payable sendNonReentrant returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The Message destination chain id.</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>User application contract address which receive the message.</td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
<tr><td><code>refund</code></td><td><code>address</code></td><td>Return extra fee to refund address.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>General extensibility for relayer to custom functionality.</td></tr>
</tbody></table>
</div>
<h3 id="importhash-1"><a class="header" href="#importhash-1">importHash</a></h3>
<p>Hash is an abstract of the proof system, it can be a block hash or a message root hash,
specifically provided by oracles.</p>
<p><em>Import hash by any oracle address.</em></p>
<pre><code class="language-solidity">function importHash(uint256 chainId, address channel, uint256 msgIndex, bytes32 hash_) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>The source chain id.</td></tr>
<tr><td><code>channel</code></td><td><code>address</code></td><td>The message channel.</td></tr>
<tr><td><code>msgIndex</code></td><td><code>uint256</code></td><td>The source chain message index.</td></tr>
<tr><td><code>hash_</code></td><td><code>bytes32</code></td><td>The hash to import.</td></tr>
</tbody></table>
</div>
<h3 id="_handlefee"><a class="header" href="#_handlefee">_handleFee</a></h3>
<pre><code class="language-solidity">function _handleFee(
    address ua,
    address refund,
    bytes32 msgHash,
    uint256 toChainId,
    uint256 gasLimit,
    bytes calldata encoded,
    bytes calldata params
) internal;
</code></pre>
<h3 id="fee-5"><a class="header" href="#fee-5">fee</a></h3>
<p>Get a quote in source native gas, for the amount that send() requires to pay for message delivery.</p>
<pre><code class="language-solidity">function fee(uint256 toChainId, address ua, uint256 gasLimit, bytes calldata encoded, bytes calldata params)
    external
    view
    returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>toChainId</code></td><td><code>uint256</code></td><td>The Message destination chain id.</td></tr>
<tr><td><code>ua</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>gasLimit</code></td><td><code>uint256</code></td><td>Gas limit for destination user application used.</td></tr>
<tr><td><code>encoded</code></td><td><code>bytes</code></td><td>The calldata which encoded by ABI Encoding.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>General extensibility for relayer to custom functionality.</td></tr>
</tbody></table>
</div>
<h3 id="_handlerelayer"><a class="header" href="#_handlerelayer">_handleRelayer</a></h3>
<pre><code class="language-solidity">function _handleRelayer(
    address relayer,
    uint256 toChainId,
    address ua,
    uint256 gasLimit,
    bytes calldata encoded,
    bytes calldata params
) internal returns (uint256);
</code></pre>
<h3 id="_handleoracle"><a class="header" href="#_handleoracle">_handleOracle</a></h3>
<pre><code class="language-solidity">function _handleOracle(address oracle, uint256 toChainId, address ua) internal returns (uint256);
</code></pre>
<h3 id="recv-1"><a class="header" href="#recv-1">recv</a></h3>
<p>Only channel could call this function.</p>
<p><em>Recv verified message from Channel and dispatch to destination user application address.</em></p>
<pre><code class="language-solidity">function recv(Message calldata message, bytes calldata proof)
    external
    payable
    recvNonReentrant
    returns (bool dispatchResult);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>Message</code></td><td>Verified receive message info.</td></tr>
<tr><td><code>proof</code></td><td><code>bytes</code></td><td>Message proof of this message.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>dispatchResult</code></td><td><code>bool</code></td><td>Result of the message dispatch.</td></tr>
</tbody></table>
</div>
<h3 id="_dispatch"><a class="header" href="#_dispatch">_dispatch</a></h3>
<p><em>Dispatch the cross chain message.</em></p>
<pre><code class="language-solidity">function _dispatch(Message memory message, bytes32 msgHash) private returns (bool dispatchResult);
</code></pre>
<h3 id="_sendvalue"><a class="header" href="#_sendvalue">_sendValue</a></h3>
<p><em>Replacement for Solidity's <code>transfer</code>: sends <code>amount</code> wei to
<code>recipient</code>, forwarding all available gas and reverting on errors.</em></p>
<pre><code class="language-solidity">function _sendValue(address recipient, uint256 amount) internal;
</code></pre>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="messageassigned"><a class="header" href="#messageassigned">MessageAssigned</a></h3>
<pre><code class="language-solidity">event MessageAssigned(
    bytes32 indexed msgHash,
    address indexed oracle,
    address indexed relayer,
    uint256 oracleFee,
    uint256 relayerFee,
    bytes params
);
</code></pre>
<h3 id="hashimported"><a class="header" href="#hashimported">HashImported</a></h3>
<pre><code class="language-solidity">event HashImported(address indexed oracle, uint256 chainId, address channel, uint256 msgIndex, bytes32 hash);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uc"><a class="header" href="#uc">UC</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/UserConfig.sol">Git Source</a></p>
<p><em>User application custom configuration.</em></p>
<pre><code class="language-solidity">struct UC {
    address oracle;
    address relayer;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Oracle contract address.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Relayer contract address.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="userconfig"><a class="header" href="#userconfig">UserConfig</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/UserConfig.sol">Git Source</a></p>
<p>User config could select their own relayer and oracle.
The default configuration is used by default.</p>
<p><em>Only setter could set default user config.</em></p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="setter"><a class="header" href="#setter">setter</a></h3>
<p><em>Setter address.</em></p>
<pre><code class="language-solidity">address public setter;
</code></pre>
<h3 id="defaultuc-1"><a class="header" href="#defaultuc-1">defaultUC</a></h3>
<p><em>Default user config.</em></p>
<pre><code class="language-solidity">UC public defaultUC;
</code></pre>
<h3 id="ucof"><a class="header" href="#ucof">ucOf</a></h3>
<p><em>ua =&gt; uc.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; UC) public ucOf;
</code></pre>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="onlysetter"><a class="header" href="#onlysetter">onlySetter</a></h3>
<pre><code class="language-solidity">modifier onlySetter();
</code></pre>
<h3 id="constructor-5"><a class="header" href="#constructor-5">constructor</a></h3>
<pre><code class="language-solidity">constructor(address dao);
</code></pre>
<h3 id="changesetter"><a class="header" href="#changesetter">changeSetter</a></h3>
<p>Only current setter could call.</p>
<p><em>Change setter.</em></p>
<pre><code class="language-solidity">function changeSetter(address newSetter) external onlySetter;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newSetter</code></td><td><code>address</code></td><td>New setter.</td></tr>
</tbody></table>
</div>
<h3 id="setdefaultconfig"><a class="header" href="#setdefaultconfig">setDefaultConfig</a></h3>
<p>Only setter could call.</p>
<p><em>Set default user config for all user application.</em></p>
<pre><code class="language-solidity">function setDefaultConfig(address oracle, address relayer) external onlySetter;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Default oracle.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Default relayer.</td></tr>
</tbody></table>
</div>
<h3 id="setappconfig-1"><a class="header" href="#setappconfig-1">setAppConfig</a></h3>
<p>Set user application config.</p>
<pre><code class="language-solidity">function setAppConfig(address oracle, address relayer) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Oracle which user application.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Relayer which user application choose.</td></tr>
</tbody></table>
</div>
<h3 id="getappconfig-1"><a class="header" href="#getappconfig-1">getAppConfig</a></h3>
<p>If user application has not configured, then the default user config is used.</p>
<p><em>Fetch user application config.</em></p>
<pre><code class="language-solidity">function getAppConfig(address ua) public view returns (UC memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ua</code></td><td><code>address</code></td><td>User application contract address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>UC</code></td><td>user application config.</td></tr>
</tbody></table>
</div>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="defaultconfigupdated"><a class="header" href="#defaultconfigupdated">DefaultConfigUpdated</a></h3>
<p><em>Notifies an observer that the default user config has updated.</em></p>
<pre><code class="language-solidity">event DefaultConfigUpdated(address oracle, address relayer);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Default oracle.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Default relayer.</td></tr>
</tbody></table>
</div>
<h3 id="appconfigupdated"><a class="header" href="#appconfigupdated">AppConfigUpdated</a></h3>
<p><em>Notifies an observer that the user application config has updated.</em></p>
<pre><code class="language-solidity">event AppConfigUpdated(address indexed ua, address oracle, address relayer);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ua</code></td><td><code>address</code></td><td>User application contract address.</td></tr>
<tr><td><code>oracle</code></td><td><code>address</code></td><td>Oracle which the user application choose.</td></tr>
<tr><td><code>relayer</code></td><td><code>address</code></td><td>Relayer which the user application choose.</td></tr>
</tbody></table>
</div>
<h3 id="setterchanged"><a class="header" href="#setterchanged">SetterChanged</a></h3>
<p><em>Notifies an observer that the setter is changed.</em></p>
<pre><code class="language-solidity">event SetterChanged(address indexed oldSetter, address indexed newSetter);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>oldSetter</code></td><td><code>address</code></td><td>Old setter address.</td></tr>
<tr><td><code>newSetter</code></td><td><code>address</code></td><td>New setter address.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="verifier"><a class="header" href="#verifier">Verifier</a></h1>
<p><a href="https://github.com/msgport/ORMP/blob/2665a54323a9da18bf06510d8b2cf41e1ad88b0a/src/Verifier.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/Verifier.sol//src/interfaces/IVerifier.sol/interface.IVerifier.html">IVerifier</a></p>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="hashof-1"><a class="header" href="#hashof-1">hashOf</a></h3>
<p>Fetch message hash.</p>
<pre><code class="language-solidity">function hashOf(uint256 chainId, address channel, uint256 msgIndex) public view virtual returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chainId</code></td><td><code>uint256</code></td><td>The source chain id.</td></tr>
<tr><td><code>channel</code></td><td><code>address</code></td><td>The message channel.</td></tr>
<tr><td><code>msgIndex</code></td><td><code>uint256</code></td><td>The Message index.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>Message hash in source chain.</td></tr>
</tbody></table>
</div>
<h3 id="verifymessageproof-1"><a class="header" href="#verifymessageproof-1">verifyMessageProof</a></h3>
<p>Verify message proof</p>
<p><em>Message proof provided by relayer. Oracle should provide message root of
source chain, and verify the merkle proof of the message hash.</em></p>
<pre><code class="language-solidity">function verifyMessageProof(Message calldata message, bytes calldata) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>Message</code></td><td>The message info.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td></td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Result of the message verify.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
